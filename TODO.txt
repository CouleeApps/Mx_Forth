Re-do function calls to allow for recursion

Add variables